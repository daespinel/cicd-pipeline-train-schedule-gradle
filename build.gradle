plugins {
  id "com.moowork.node" version "1.2.0"
}

// Download and install node.js and npm locally

node {
  download = true
}

task build

task zip(type: Zip) {
// take as context the actual directory
	from ('.') {
// Grab the root directory files and after that everything in the file tree
	  include "*"
	  include "bin/**"
	  include "data/**"
	  include "node_modules/**"
	  include "public/**"
	  include "routes/**"
	  include "views/**"
	}
	destinationDir(file("dist"))
	baseName "trainSchedule"
}

// Tasks dependencies should be written in the best order to avoid unexpected behavior

build.dependsOn zip
build.dependsOn npm_build
npm_build.dependsOn npm_test
npm_test.dependsOn npmInstall
